require 'test_helper'

class IncomingEmailTest < ActiveSupport::TestCase
  def test_should_be_valid
    assert true
  end

  test "create new email with proper attributes for plaintext" do
    mail = IncomingEmail.new("From gdraper@vt.edu  Mon Dec 12 11:40:01 2011\nReturn-Path: <gdraper@vt.edu>\nX-Original-To: help@it.recsports.vt.edu\nDelivered-To: help@it.recsports.vt.edu\nReceived: from saruman.cc.w2k.vt.edu (saruman.cc.vt.edu [198.82.160.23])\n\tby gambit.recsports.vt.edu (Postfix) with ESMTP id E93F960036\n\tfor <help@it.recsports.vt.edu>; Mon, 12 Dec 2011 11:40:01 -0500 (EST)\nReceived: from fangorn.cc.w2k.vt.edu ([198.82.160.35]) by\n saruman.cc.w2k.vt.edu ([198.82.160.23]) with mapi; Mon, 12 Dec 2011 11:39:59\n -0500\nFrom: \"Draper, Gregory\" <gdraper@vt.edu>\nTo: \"help@it.recsports.vt.edu\" <help@it.recsports.vt.edu>\nDate: Mon, 12 Dec 2011 11:39:59 -0500\nSubject: blue\nThread-Topic: blue\nThread-Index: Acy47LB5GxwBLs9ARTum2ADlSpf2VA==\nMessage-ID: <43C5B24D-A6D0-4803-9E68-CBA64BE46DAE@vt.edu>\nAccept-Language: en-US\nContent-Language: en-US\nX-MS-Has-Attach:\nX-MS-TNEF-Correlator:\nacceptlanguage: en-US\nContent-Type: text/plain; charset=\"us-ascii\"\nContent-Transfer-Encoding: quoted-printable\nMIME-Version: 1.0\n\nblue\n")
    assert_equal "blue", mail.body.to_s
  end

  test "create new email with proper attributes for html from lindsay" do
    mail = IncomingEmail.new("From lmkidd@vt.edu  Fri Dec  9 13:44:53 2011\nReturn-Path: <lmkidd@vt.edu>\nX-Original-To: help@it.recsports.vt.edu\nDelivered-To: help@it.recsports.vt.edu\nReceived: from saruman.cc.w2k.vt.edu (saruman.cc.vt.edu [198.82.160.23])\n\tby gambit.recsports.vt.edu (Postfix) with ESMTP id B8A1B60033\n\tfor <help@it.recsports.vt.edu>; Fri,  9 Dec 2011 13:44:53 -0500 (EST)\nReceived: from fangorn.cc.w2k.vt.edu ([198.82.160.35]) by\n saruman.cc.w2k.vt.edu ([198.82.160.23]) with mapi; Fri, 9 Dec 2011 13:44:57\n -0500\nFrom: \"Kidd, Lindsay\" <lmkidd@vt.edu>\nTo: \"help@it.recsports.vt.edu\" <help@it.recsports.vt.edu>\nDate: Fri, 9 Dec 2011 13:44:56 -0500\nSubject: One Time Offer Button\nThread-Topic: One Time Offer Button\nThread-Index: Acy2oZp1po4pI4wSSPyGAHjrxWmdhQ==\nMessage-ID: <DFE27A3598EA47438437DFAD763C214423B8798AB8@fangorn.cc.w2k.vt.edu>\nAccept-Language: en-US\nContent-Language: en-US\nX-MS-Has-Attach: yes\nX-MS-TNEF-Correlator:\nacceptlanguage: en-US\nContent-Type: multipart/related;\n\tboundary=\"_004_DFE27A3598EA47438437DFAD763C214423B8798AB8fangornccw2kv_\";\n\ttype=\"multipart/alternative\"\nMIME-Version: 1.0\n\n--_004_DFE27A3598EA47438437DFAD763C214423B8798AB8fangornccw2kv_\nContent-Type: multipart/alternative;\n\tboundary=\"_000_DFE27A3598EA47438437DFAD763C214423B8798AB8fangornccw2kv_\"\n\n--_000_DFE27A3598EA47438437DFAD763C214423B8798AB8fangornccw2kv_\nContent-Type: text/plain; charset=\"us-ascii\"\nContent-Transfer-Encoding: quoted-printable\n\nThe one time offer button in Check In is only showing up for those that hav=\ne already received the offer.  There is no button for those that have not r=\neceived the offer and we are providing a shirt to.  This is not incredibly =\nimportant for this offer (it's just more iWorkout shirts), but we will need=\n that fixed for future offers.\n\nThanks!\n\nLindsay Kidd\nMcComas Facility Manager\nVirginia Tech Recreational Sports\n142 McComas Hall (0358)\nBlacksburg, VA  24061\nPhone:  540-231-3045\nFax:  540-231-6273\n[cid:image001.png@01CCB678.36E415F0]\n\n\n\n--_000_DFE27A3598EA47438437DFAD763C214423B8798AB8fangornccw2kv_\nContent-Type: text/html; charset=\"us-ascii\"\nContent-Transfer-Encoding: quoted-printable\n\n<html xmlns:v=3D\"urn:schemas-microsoft-com:vml\" xmlns:o=3D\"urn:schemas-micr=\nosoft-com:office:office\" xmlns:w=3D\"urn:schemas-microsoft-com:office:word\" =\nxmlns:m=3D\"http://schemas.microsoft.com/office/2004/12/omml\" xmlns=3D\"http:=\n//www.w3.org/TR/REC-html40\"><head><meta http-equiv=3DContent-Type content=\n=3D\"text/html; charset=3Dus-ascii\"><meta name=3DGenerator content=3D\"Micros=\noft Word 14 (filtered medium)\"><!--[if !mso]><style>v\\:* {behavior:url(#def=\nault#VML);}\no\\:* {behavior:url(#default#VML);}\nw\\:* {behavior:url(#default#VML);}\n.shape {behavior:url(#default#VML);}\n</style><![endif]--><style><!--\n/* Font Definitions */\n@font-face\n\t{font-family:Calibri;\n\tpanose-1:2 15 5 2 2 2 4 3 2 4;}\n@font-face\n\t{font-family:Tahoma;\n\tpanose-1:2 11 6 4 3 5 4 4 2 4;}\n/* Style Definitions */\np.MsoNormal, li.MsoNormal, div.MsoNormal\n\t{margin:0in;\n\tmargin-bottom:.0001pt;\n\tfont-size:11.0pt;\n\tfont-family:\"Calibri\",\"sans-serif\";}\na:link, span.MsoHyperlink\n\t{mso-style-priority:99;\n\tcolor:blue;\n\ttext-decoration:underline;}\na:visited, span.MsoHyperlinkFollowed\n\t{mso-style-priority:99;\n\tcolor:purple;\n\ttext-decoration:underline;}\np.MsoAcetate, li.MsoAcetate, div.MsoAcetate\n\t{mso-style-priority:99;\n\tmso-style-link:\"Balloon Text Char\";\n\tmargin:0in;\n\tmargin-bottom:.0001pt;\n\tfont-size:8.0pt;\n\tfont-family:\"Tahoma\",\"sans-serif\";}\nspan.EmailStyle17\n\t{mso-style-type:personal-compose;\n\tfont-family:\"Calibri\",\"sans-serif\";\n\tcolor:windowtext;\n\tfont-weight:normal;\n\tfont-style:normal;}\nspan.BalloonTextChar\n\t{mso-style-name:\"Balloon Text Char\";\n\tmso-style-priority:99;\n\tmso-style-link:\"Balloon Text\";\n\tfont-family:\"Tahoma\",\"sans-serif\";}\n.MsoChpDefault\n\t{mso-style-type:export-only;\n\tfont-family:\"Calibri\",\"sans-serif\";}\n@page WordSection1\n\t{size:8.5in 11.0in;\n\tmargin:1.0in 1.0in 1.0in 1.0in;}\ndiv.WordSection1\n\t{page:WordSection1;}\n--></style><!--[if gte mso 9]><xml>\n<o:shapedefaults v:ext=3D\"edit\" spidmax=3D\"1026\" />\n</xml><![endif]--><!--[if gte mso 9]><xml>\n<o:shapelayout v:ext=3D\"edit\">\n<o:idmap v:ext=3D\"edit\" data=3D\"1\" />\n</o:shapelayout></xml><![endif]--></head><body lang=3DEN-US link=3Dblue vli=\nnk=3Dpurple><div class=3DWordSection1><p class=3DMsoNormal>The one time off=\ner button in Check In is only showing up for those that have already receiv=\ned the offer.&nbsp; There is no button for those that have not received the=\n offer and we are providing a shirt to.&nbsp; This is not incredibly import=\nant for this offer (it&#8217;s just more iWorkout shirts), but we will need=\n that fixed for future offers.<o:p></o:p></p><p class=3DMsoNormal><o:p>&nbs=\np;</o:p></p><p class=3DMsoNormal>Thanks!<o:p></o:p></p><p class=3DMsoNormal=\n><o:p>&nbsp;</o:p></p><p class=3DMsoNormal><b><i><span style=3D'color:#6324=\n23'>Lindsay Kidd<o:p></o:p></span></i></b></p><p class=3DMsoNormal><b><i><s=\npan style=3D'color:#632423'>McComas Facility Manager<o:p></o:p></span></i><=\n/b></p><p class=3DMsoNormal><b><i><span style=3D'color:#632423'>Virginia Te=\nch Recreational Sports<o:p></o:p></span></i></b></p><p class=3DMsoNormal><b=\n><i><span style=3D'color:#632423'>142 McComas Hall (0358)<o:p></o:p></span>=\n</i></b></p><p class=3DMsoNormal><b><i><span style=3D'color:#632423'>Blacks=\nburg, VA&nbsp; 24061<o:p></o:p></span></i></b></p><p class=3DMsoNormal><b><=\ni><span style=3D'color:#632423'>Phone:&nbsp; 540-231-3045<o:p></o:p></span>=\n</i></b></p><p class=3DMsoNormal><b><i><span style=3D'color:#632423'>Fax:&n=\nbsp; 540-231-6273<o:p></o:p></span></i></b></p><p class=3DMsoNormal><i><spa=\nn style=3D'color:#632423'><img width=3D161 height=3D37 id=3D\"Picture_x0020_=\n1\" src=3D\"cid:image001.png@01CCB678.36E415F0\"></span></i><i><span style=3D'=\ncolor:#632423'><o:p></o:p></span></i></p><p class=3DMsoNormal><i><span styl=\ne=3D'color:#632423'><o:p>&nbsp;</o:p></span></i></p><p class=3DMsoNormal><o=\n:p>&nbsp;</o:p></p></div></body></html>=\n\n--_000_DFE27A3598EA47438437DFAD763C214423B8798AB8fangornccw2kv_--\n\n--_004_DFE27A3598EA47438437DFAD763C214423B8798AB8fangornccw2kv_\nContent-Type: image/png; name=\"image001.png\"\nContent-Description: image001.png\nContent-Disposition: inline; filename=\"image001.png\"; size=1763;\n\tcreation-date=\"Fri, 09 Dec 2011 13:44:56 GMT\";\n\tmodification-date=\"Fri, 09 Dec 2011 13:44:56 GMT\"\nContent-ID: <image001.png@01CCB678.36E415F0>\nContent-Transfer-Encoding: base64\n\n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\n\n--_004_DFE27A3598EA47438437DFAD763C214423B8798AB8fangornccw2kv_--\n")
    assert mail.body.to_s.include?("There is no button")
    assert !mail.body.include?("Content-Transfer-Encoding")
  end
  

end
